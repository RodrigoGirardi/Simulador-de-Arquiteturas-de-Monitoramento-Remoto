import socket

def serv():
    HOST = '10.32.160.83'
    PORT = 3535
    recebe = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    recebe.bind(('10.32.160.83', 3535))
    recebe.listen(1)
    print('Aguardando conexão de um cliente...')
    print(HOST)
    print(PORT)

    sc, endereco = recebe.accept()  # Aceita a conexão e obtém o objeto de soquete e o endereço do cliente
    ler_buffer = sc.recv(1024)
    while True:
        arquivof = open("/Users/Rodrigo Girardi/Desktop/Base/Instituto Butantan/Socket/Transf_de_Arq/dataset.csv", 'wb')
        fim = 0
        while fim == 0:
            
            while ler_buffer:
                arquivof.write(ler_buffer)
                ler_buffer = sc.recv(1024)
                fim = 1
        arquivof.close()
        sc.close()

serv()